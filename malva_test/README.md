[![Anaconda-Server Badge](https://anaconda.org/bioconda/malva/badges/platforms.svg)](https://anaconda.org/bioconda/malva)
[![Anaconda-Server Badge](https://anaconda.org/bioconda/malva/badges/license.svg)](https://anaconda.org/bioconda/malva)

# MALVA-TEST: Workflow for testing MALVA Output

Compare the .vcf output generated by MALVA with a reference SAMPLE .vcf verifying its accuracy. 

## Install from source code

### Dependencies

To manually compile MALVA-TEST you'll need the following libraries and tools installed in your system.

* [htslib >= v1.10.2](https://github.com/samtools/htslib/tree/1.10.2)
* zlib

Use your favorite system-wide package manager to install them before compiling MALVA-TEST.

For example, on ubuntu
```shell
$ sudo apt install -y libhts-dev zlib1g-dev
```

### Download and installation

To download and compile the code run the following commands.

```shell
$ cd malva/malva_test/
$ make
```

## Usage
```
Usage: malva-test -t [tolerance_value] <output_malva.vcf> <sample.vcf>
Arguments(optional):
    -t                                  tolerance range match of GQ (default 0)
Positional Arguments(mandatory):
    <output_malva.vcf>                  variants file in VCF format.
    <sample.vcf>                        variants file in VCF format.
```
REQUIREMENTS: The RECORDS of <output_malva.vcf> <sample.vcf> must be of the same number and sorted. 
              Tolerance value must be between 0 and 100. 

## Example
After you compiled `malva-test`, you can test it on the example data provided:
```
./malva-test geno.example.vcf sample.example.vcf 
```
This should take less than 1 minute to complete.
Change the values of some records of "geno.example.vcf" to test the accuracy (I changed two records below).

Example output(with two record not found):
```
./malva-test -t 20 geno.example.vcf sample.example.vcf 

Compare "geno.example.vcf" with "sample.example.vcf"

<< NOT FOUND: #CHROM 2 #POS 60343 #ID rs527639301 #REF G #ALT A #DONOR 0|0:0 >>
<< NOT FOUND: #CHROM 20 #POS 60419 #ID rs538242240 #REF A #ALT G #DONOR 0|0:50 >>

Records Matched: 245, Records Processed: 247
Value of Precision: 99.1903%
```

### Note
- The tool has been tested only on 64bit Linux system.

## License
MALVA-TEST is distributed under the GPL-3.0-or-later license.